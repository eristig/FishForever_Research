---
title: "Governance Analysis"
author: "Larissa Neilson"
date: "4/15/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(janitor)
library(broom)
library(ordinal)
library(MASS)
library(ggeffects)
library(effects)
library(forcats)
library(gtsummary)
```

First, we need to join our country staff survey data to the HHS data. Then, we need to look at the variables and determine if we should use an Ordinal Logistic Regression or a Binary Logistic Regression.

### Our predictors of governance

- Governance in law
- Governance in practice
- Who's responsible for enforcement (HHS Q)

### Outcome

#### Four fisher archetypes:

- Committed
- Supportive
- Ambivalent
- Resistant

#### Also consider these variables:

- Country
- Perceived catch
- Food security / job security

```{r}
# Read in the data
hhs_all_complete <- read_csv("hhs_all_complete.csv")
scaled_sum <- read_csv("scaled_sum.csv") 
scaled_km_df <- read_csv("scaled_km_df.csv") %>% # Use this one
  mutate(cluster_no = recode_factor(cluster_no,
                                    "Wavering" = "Ambivalent")) %>%
  mutate(x19_current_fish_catch = fct_relevel(x19_current_fish_catch,
                                              "Improved heavily",
                                              "Improved slightly",
                                              "Stayed the same",
                                              "Declined slightly",
                                              "Declined a lot")) %>% 
 # mutate(x49_enforcement_responsible = fct_relevel(x49_enforcement_responsible,
                                              #"Fisheries Management Body",
                                              #"No enforcement system",
                                              #"Myself",
                                              #"Subnational Government",
                                              #"National Government")) %>%
  mutate(cluster_no = fct_relevel(cluster_no,
                                  "Committed",
                                  "Supportive",
                                  "Ambivalent",
                                  "Resistant")) 
staff_survey <- read_csv("staff_survey.csv")
```


```{r}
# Join staff survey data with HHS data
gov_data <- inner_join(scaled_km_df, staff_survey, by = "ma_name")

gov_data <- gov_data %>%
  dplyr::select(ma_name, gov_law, gov_practice, country, x6_gender, x49_enforcement_responsible, x54_food_availability, cluster_no)
```

We will use Multiple Logistic Regression

```{r}
# Get the data ready for OLR
str(gov_data)

gov_data$gov_law <- as.factor(gov_data$gov_law)
gov_data$gov_practice <- as.factor(gov_data$gov_practice)

gov_data <- gov_data %>%
  drop_na()

summary(gov_data)
```


```{r}
# Perform OLR + data viz
# JUST with governance in law and in practice first
gov_data_olr <- clm(cluster_no ~ gov_law + gov_practice, data = gov_data, link = "logit")

summary(gov_data_olr)
confint(gov_data_olr)
exp(coef(gov_data_olr))
exp(confint(gov_data_olr))
```

#### Interpreting OLR results:

First, our ordinal outcome variable goes from Committed --> Resistant
So, a negative coefficient represents a negative association between the predictor variable and how resistant fishers are in the MAA.

A positive coefficient represents a positive association between the predictor variable and how resistant fishers are in the MAA.


- An MAA that is true co-management under law, as opposed to another form of governance, is associated with a higher likelihood of having more committed fishers

- An MAA that is more top-down in practice, as opposed to another form of governance, is associated with a higher likelihood of having more resistant fishers

- An MAA that is true co-management in practice, as opposed to another form of governance, is associated with a higher likelihood of having more resistant fishers

All of these are significant findings. 

Example sentence:

There was a positive association between a MAA being more top-down in practice and having more resistant-leaning fishers B = 0.93, SE = 0.08, p = < 2e-16, 95% CI = 0.78 to 1.08

```{r}
# Run model including enforcement responsibility + governance
# Have to remove Honduras because they allowed multiple answers for Q49 
gov_no_hd <- gov_data %>% 
  filter(!country == "HND")

gov_no_hd_olr <- clm(cluster_no ~ gov_law + gov_practice + x49_enforcement_responsible, data = gov_no_hd, link = "logit")

summary(gov_no_hd_olr)
confint(gov_no_hd_olr)
exp(coef(gov_no_hd_olr))
exp(confint(gov_no_hd_olr))

# Run model including other possible predictors (country, gender, enforcement, food availability)
gov_ctry_olr <- clm(cluster_no ~ country + x6_gender + x49_enforcement_responsible + x54_food_availability, data = gov_no_hd, link = "logit")

summary(gov_ctry_olr)
confint(gov_ctry_olr)
exp(coef(gov_ctry_olr))
exp(confint(gov_ctry_olr))

```





















