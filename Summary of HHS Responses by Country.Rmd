---
output: 
html_document:
  theme: lumen
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE)
```


```{r, include = FALSE, echo = FALSE}
# Load packages
library(tidyverse)
library(janitor)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(knitr)
library(naniar)
library(here)
library(dplyr)
library(scales)
library(stringr)

```


```{r, include = FALSE}
# Read in the data

# Indonesia
hhs_indonesia <- read_csv(here::here("raw_data", "hhs", "hhs_indonesia_raw.csv")) %>%
  clean_names()

# Brazil
hhs_brazil <- read_csv(here::here("raw_data", "hhs", "hhs_brazil_raw.csv")) %>%
  clean_names()

# Honduras
hhs_honduras <- read_csv(here::here("raw_data", "hhs", "hhs_honduras_raw.csv")) %>%
  clean_names()

# Micronesia
hhs_micronesia <- read_csv(here::here("raw_data", "hhs", "hhs_micronesia_raw.csv")) %>%
  clean_names()

# Mozambique
hhs_mozambique <- read_csv(here::here("raw_data", "hhs", "hhs_mozambique_raw.csv")) %>%
  clean_names()

# Philippines
hhs_philippines <- read_csv(here::here("raw_data", "hhs", "hhs_philippines_raw.csv")) %>%
  clean_names()

# Palau
hhs_palau <- read_csv(here::here("raw_data", "hhs", "hhs_palau_raw.csv")) %>%
  clean_names()

```

###### Updates from 8/4/21

OK, I (Dylan) had a great chat with Larissa Yesterday. 
She showed me the updated data from Rare, which has a cleaner version of the global hhs data, that she put together really nicely into `hhs_all_complete` 

I'll edit a good amount of this code to mathc this new, cleaner data, but it will all be worth it in the long run (I think...!)


With that, I'll jsut create another version of the `hhs_all_complete` called `hhs_portal_complete`

```{r}
hhs_portal_complete <- read_csv(here("Fisnew_portal_data", "hhs_all_complete.csv"))
```





```{r}
# Created combined dataframe

## Convert columns that are in "double" or "logical" format to "character" format so that they can be combined with other datasets
# hhs_indonesia_converted <- hhs_indonesia %>%
#   mutate(x27n_emergency_other = as.character(x27n_emergency_other)) %>% 
#   mutate(x40_reserve_boundaries_aware = as.character(x40_reserve_boundaries_aware))
# 
# hhs_honduras_converted <- hhs_honduras %>%
#   mutate(x27n_emergency_other = as.character(x27n_emergency_other)) %>% 
#   mutate(x40_reserve_boundaries_aware = as.character(x40_reserve_boundaries_aware)) %>% 
#   mutate(x70_hh_average_income = as.numeric(x70_hh_average_income))
# 
# hhs_micronesia_converted <- hhs_micronesia %>%
#   mutate(x27n_emergency_other = as.character(x27n_emergency_other)) %>% 
#   mutate(x40_reserve_boundaries_aware = as.character(x40_reserve_boundaries_aware))
# 
# hhs_philippines_converted <- hhs_philippines %>%
#   mutate(x24p_item_other_specify = as.character(x24p_item_other_specify)) %>% 
#   mutate(x27n_emergency_other = as.character(x27n_emergency_other)) %>% 
#   mutate(x40_reserve_boundaries_aware = as.character(x40_reserve_boundaries_aware))
# 
# hhs_palau_converted <- hhs_palau %>%
#   mutate(x27n_emergency_other = as.character(x27n_emergency_other)) %>% 
#   mutate(x40_reserve_boundaries_aware = as.character(x40_reserve_boundaries_aware)) 
# 
# hhs_global <- bind_rows(list(hhs_brazil, hhs_honduras_converted, hhs_indonesia_converted, hhs_micronesia_converted, hhs_mozambique, hhs_philippines_converted, hhs_palau_converted))

#write_csv(hhs_global, "hhs_global.csv", append = FALSE)

```

<div align="left"> <font size="+3"> **Summary of HHS Responses** </font> 
<div align="center"> <font size="+2"> Country by Country Breakdown </font> 


***



```{r}
#<div align="left"> <font size="+3"> **Unique Answers per Question** </font>

#create unique function by question
# unique_qs <- function(hhs_global, question){
#   
#   question <- hhs_global %>% 
#   group_by(country) %>%
#   distinct(question) %>% 
#   select(question) %>% 
#   arrange(country, -question)
# 
# question_table <- knitr::kable(question, format = "html", caption = "question") %>% 
#   kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "left") %>% 
#   collapse_rows(columns = 1, valign = "middle")
# 
# return(question_table)
# 
# }
# 
# ### create vector for loop
# question <- hhs_global$(x43_ma_benefits, x43_ma_benefits_opinion)
# 
# ### create loop 
# for (i in seq_along(question)) {
#   unique_qs(hhs_global, question[i])
# }
# 
# 
# 
# x10_mpa_important
# 
# x43_ma_benefits <- hhs_global %>% 
#   group_by(country, distinct(x43_ma_benefits)) %>%
#   distinct(x43_ma_benefits) %>% 
#   select(x43_ma_benefits) %>% 
#   arrange(country, -x43_ma_benefits)
# 
# knitr::kable(x43_ma_benefits, format = "html", caption = "x43_ma_benefits") %>% 
#   kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "left") %>% 
#   collapse_rows(columns = 1, valign = "middle")
# 
# x43_ma_benefits_opinion <- hhs_global %>% 
#   group_by(country) %>%
#   distinct(x43_ma_benefits_opinion) %>% 
#   select(x43_ma_benefits_opinion) %>% 
#   arrange(country, x43_ma_benefits_opinion)
# 
# knitr::kable(x43_ma_benefits_opinion, format = "html", caption = "x43_ma_benefits_opinion") %>% 
#   kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "left") %>% 
#   collapse_rows(columns = 1, valign = "middle")
# 

# 
# hhs_global_answers <- hhs_global[!duplicated(hhs_global[ , c("x43_ma_benefits", "x43_ma_benefits_opinion", "x49_enforcement_responsible")]), ] %>% 
#   select(x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible)
# 
# hhs_global_answers
# 
# , x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x46_represent_interests, x47_represent_contributions
# 
#   select(x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x46_represent_interests, x47_represent_contributions) 

```


```{r, include = FALSE}
hhs_global <- read_csv("hhs_global.csv")
```

***

<div align="left"> <font size="+3"> **Indonesia** </font>

```{r}
# Summary Survey Data - Location breakdown

## Indonesia
# Create subset for location breakdown of surveys
indonesia_summary <- hhs_indonesia %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(indonesia_summary, format = "html", caption = "Indonesia Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(indonesia_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")

## Engagement data summary
# Create subset for engagement relevant questions
indonesia_engagement <- hhs_indonesia %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(indonesia_engagement, format = "html", caption = "Indonesia Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(indonesia_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
# Create subset for engagement relevant questions
indonesia_agreement <- hhs_indonesia %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(indonesia_agreement, format = "html", caption = "Indonesia Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(indonesia_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

```

***

<div align="left"> <font size="+3"> **Brazil** </font>

```{r}
# Summary Survey Data - Location breakdown

## Brazil
# Create subset for location breakdown of surveys
brazil_summary <- hhs_brazil %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(brazil_summary, format = "html", caption = "Brazil Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(brazil_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")

## Engagement data summary
# Create subset for engagement relevant questions
brazil_engagement <- hhs_brazil %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(brazil_engagement, format = "html", caption = "Brazil Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(brazil_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
# Create subset for engagement relevant questions
brazil_agreement <- hhs_brazil %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(brazil_agreement, format = "html", caption = "Brazil Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(brazil_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

***

<div align="left"> <font size="+3"> **Honduras** </font>

```{r}
## Honduras
# Create subset for location breakdown of surveys
honduras_summary <- hhs_honduras %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(honduras_summary, format = "html", caption = "Honduras Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(honduras_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")

## Engagement data summary
# Create subset for engagement relevant questions
honduras_engagement <- hhs_honduras %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(honduras_engagement, format = "html", caption = "Honduras Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(honduras_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
# Create subset for engagement relevant questions
honduras_agreement <- hhs_honduras %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(honduras_agreement, format = "html", caption = "Honduras Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(honduras_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

***

<div align="left"> <font size="+3"> **Micronesia** </font>

```{r}
## Micronesia
# Create subset for location breakdown of surveys
micronesia_summary <- hhs_micronesia %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(micronesia_summary, format = "html", caption = "Micronesia Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(micronesia_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")

## Engagement data summary
# Create subset for engagement relevant questions
micronesia_engagement <- hhs_micronesia %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(micronesia_engagement, format = "html", caption = "Micronesia Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(micronesia_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
# Create subset for engagement relevant questions
micronesia_agreement <- hhs_micronesia %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(micronesia_agreement, format = "html", caption = "Micronesia Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(micronesia_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

***

<div align="left"> <font size="+3"> **Mozambique** </font>

```{r}
## Mozambique
# Create subset for location breakdown of surveys
mozambique_summary <- hhs_mozambique %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(mozambique_summary, format = "html", caption = "Mozambique Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(mozambique_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")


## Engagement data summary
# Create subset for engagement relevant questions
mozambique_engagement <- hhs_mozambique %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(mozambique_engagement, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(mozambique_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
# Create subset for engagement relevant questions
mozambique_agreement <- hhs_mozambique %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(mozambique_agreement, format = "html", caption = "Mozambique Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(mozambique_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

***

<div align="left"> <font size="+3"> **Philippines** </font>

```{r}
## Philippines
# Create subset for location breakdown of surveys
philippines_summary <- hhs_philippines %>% 
  count(level1_name, level2_name, level3_name, ma_name) %>% 
  #arrange(-n) %>% 
  mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Subnational Government" = level1_name)
  
  # Create location breakdown table
knitr::kable(philippines_summary, format = "html", caption = "Philippines Data Summary") %>% 
  #column_spec(1, italic = TRUE) %>% 
  row_spec(dim(philippines_summary)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>% 
  collapse_rows(columns = 1, valign = "middle")

## Engagement data summary
# Create subset for engagement relevant questions
philippines_engagement <- hhs_philippines %>%
  select(c(1:12, x43_ma_benefits, x43_ma_benefits_opinion, x49_enforcement_responsible, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x62_reserve_compliance, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve, x66_response_fishing_reserve, x66_reaction_fishing_reserve)) %>% 
  drop_na(13, 15:27, 29:30) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(philippines_engagement, format = "html", caption = "Philippines Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(philippines_engagement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
### Here we include MORE than the actual amount of agreement-related questions. These include Qs 30 and 31, regarding social capital and trust (of their communities to respect the rules)

# Create subset for engagement relevant questions [DG: I changed this, so the final version is down below!]
philippines_agreement <- hhs_philippines %>%
  select(c(1:12, x10_mpa_important, x30_trust_fishers_community, x30_trust_fishers_other, x31_my_community_ability, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, x61e_violations_decrease_profit, x61f_rights_distribution_fair, x61g_fishing_change_behavior, x61h_individual_behavior, x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na(13:17, 19:31, 33) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(philippines_agreement, format = "html", caption = "Philippines Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(philippines_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


#### Dylan explores PCA with current survey responses

First, I'll look at what df we could responsibly normalize for a PCA


So, what df are there?


I'm playing with the Phillipines df to see if we can can a >0 total for responses that answered all the agreement questions
```{r}


philippines_agreement_dg <- hhs_philippines %>%
  select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
 drop_na(13, 14, 16:21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

```


Yahoo!! I did several iterations of drop_na() and selecting variables. 


 When we only select the **Agreement** questions  we see some really high numbers. 61(a) ws dragging this number down significantly, so I 
From there, once I have a strong df from 'The Phils' called "philippines_agreement_dg"  


##### Here is the finalized table for the Philippines Agreement questions

```{r}
knitr::kable(philippines_agreement_dg, format = "html", caption = "Philippines Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(philippines_agreement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

##### I'll copy this agreement process (filtering and making tables) for each country


Up next, mozambique: 


```{r}
mozambique_agreement_dg <- hhs_mozambique %>%
  select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
 drop_na(13, 14, 16:21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)
```


##### Edited table for Mozambique Agreement

```{r}
knitr::kable(mozambique_agreement_dg, format = "html", caption = "Mozambique Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(mozambique_agreement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

##### New Agreement methods + Table for Micronesia

```{r}
micronesia_agreement_dg <- hhs_micronesia %>%
  select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
 drop_na(13, 14, 16:21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create Agreement questions breakdown table
knitr::kable(micronesia_agreement_dg, format = "html", caption = "Micronesia Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(micronesia_agreement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


##### Edited Agreement Method + Table for *Indonesia*
**This edit is the only one that is NOT final**
```{r}
indonesia_agreement_dg <- hhs_indonesia %>%
  select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
 drop_na(13, 14, 18, 19, 21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

## Here, two questions have high NAs, bringing down totals significantly:
## 1. "x46_represent_interests"
## 2. "x47_represent_contributions" 
## When both are included: 130 observations. 
## removing x47 gives us 132, and removing x46 gives us 135
## Remove both, and we have 2358. Why?? 


# # Create agreement questions breakdown table
knitr::kable(indonesia_agreement_dg, format = "html", caption = "Indonesia Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(indonesia_agreement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


##### Honduras with Edited Agreement

```{r}
honduras_agreement_dg <- hhs_honduras %>%
 select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
 drop_na(13, 14, 16:21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)


# # Create engagement questions breakdown table
knitr::kable(honduras_agreement_dg, format = "html", caption = "Honduras Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(honduras_agreement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


##### Agreement [edited] method + Table for Brazil

```{r}
brazil_agreement_dg <- hhs_brazil %>%
  select(c(1:12, x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations,  x63_fishing_in_reserve, x63_times_fishing_reserve, x64_wrong_fishing_reserve)) %>% 
  drop_na( 16:21, 23) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(brazil_agreement, format = "html", caption = "Brazil Surveys - Agreement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(brazil_agreement)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


OK! Here we have re-done all the *agreement* tables. From here, I'll do the same for engagement. I'll then hide the previous code bits in the adapted Rmd. Today, I'll also try to recode 0s and 1s. 

NOTE TO DYL: Still need to go over Indonesia numbers with TQ. 


#### Rehsaping Engagement
##### Goal: Retain a robust set of answered questions, and increase N to several thousand. 


Let's start with the Philippines again

```{r}
philippines_engagement_dg <- hhs_philippines %>% 
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible, x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) %>% 
  drop_na(13:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(philippines_engagement_dg, format = "html", caption = "Philippines Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(philippines_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

## Agreement data summary
### Here we include MORE than the actual amount of engagement-related questions. These include Qs 30 and 31, regarding social capital and trust (of their communities to respect the rules) 
```

That was a solid edit! Removed a host fo questions. BUT we still ahve Erin's old tables, to look at what questions we may want to add back. 

Now let's do the rest of the countries. 

##### Edited Engagement: Mozambique

```{r}
mozambique_engagement_dg <-  hhs_mozambique %>%
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible, x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) %>% 
  drop_na(13:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(mozambique_engagement_dg, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(mozambique_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```


Done, this went from 0 --> 1077 observations.

Here comes Micronesia (it's like the olympics)

```{r}
micronesia_engagement_dg <- hhs_micronesia %>%  
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible, x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) %>% 
  drop_na(13:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(micronesia_engagement_dg, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(micronesia_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```

Again, we start with 0 responses, and now have 1300

##### Edited Engagement for **Indonesia**

```{r}
indonesia_engagement_dg <- hhs_indonesia %>%
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible,  x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) %>% 
  drop_na(15:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)
## This df is with 44 and 45 [REDACTED]


# # Create engagement questions breakdown table
knitr::kable(indonesia_engagement_dg, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(indonesia_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
  
```

OK, with indo, we once again have some edits to make
44 and 45 have a TON of NAs. Was Indonesia further behind implementation when this survey was done? 
OR - do folks there really not engage with the rules. 


##### Notes with TQ
Non-answer = NO


Anyway - on to the next 

##### Edited Engagement for: **Honduras**


```{r}
honduras_engagement_dg <- hhs_honduras %>%
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible,  x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) %>% 
  drop_na(13:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(honduras_engagement_dg, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(honduras_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")

```


One more!

##### Edited Engagement for **Brazil**

```{r}

brazil_engagement_dg <- hhs_brazil %>%
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x49_enforcement_responsible,  x53_encourage_regulations, x61f_rights_distribution_fair, x61g_fishing_change_behavior)) 
  drop_na(15:18) %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  # mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Engagement' questions answered" = n)

# # Create engagement questions breakdown table
knitr::kable(honduras_engagement_dg, format = "html", caption = "Mozambique Surveys - Engagement Questions") %>%
  #column_spec(1, italic = TRUE) %>%
  row_spec(dim(honduras_engagement_dg)[1], bold = TRUE) %>%
  kable_styling(c("condensed", "responsive", "bordered"), full_width = F, position = "right") %>%
  collapse_rows(columns = 1, valign = "middle")
```








#### Switching variables to 1s and 0s

Problem: There is uneven coding for a lot of questions. 
Particularly where answers are "Yes," "No," "No Answer," or "NA" 
This is further mixed up by answers that add gender specifics. It's a mess, kinda. 

We'll play with a few variables -n `hhs_mozambique`
The df here aren't anything final, rather they jsut show HOW we can use stringR to change the names of observations. 
```{r}
View(hhs_mozambique)



hhs_mozambique_nb <- hhs_mozambique %>% 
  select(x44_meeting_attendance, x45_leadership_position) %>% 
  mutate_at(c(1:2), ~replace(., is.na(.), 0)) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "Yes male", replacement = "yes")) %>% 
      mutate(x44_meeting_attendance =
    str_replace(x44_meeting_attendance,
                pattern = "Yes female", replacement = "yes")) %>%
  mutate(x44_meeting_attendance =
    str_replace(x44_meeting_attendance,
                pattern = "No", replacement = "no")) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "not sure", replacement = "no")) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "No", replacement = "no")) %>%
  mutate(x44_meeting_attendance = ifelse(x44_meeting_attendance == "no",0,1)) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "Yes male", replacement = "yes")) %>% 
      mutate(x45_leadership_position =
    str_replace(x45_leadership_position,
                pattern = "Yes female", replacement = "yes")) %>%
  mutate(x45_leadership_position =
    str_replace(x45_leadership_position,
                pattern = "No", replacement = "no")) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "not sure", replacement = "no")) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "No", replacement = "no")) %>%
  mutate(x45_leadership_position = ifelse(x45_leadership_position == "no",0,1))
  
  
  
```


Now, we're going to take hhs_global, include all the **supporting** questions, and "filter for" the Engagement and Agreement Questions (which will mean using drop_na)


```{r}
global_filtered <- hhs_global %>%
  select(c(1:12, x44_meeting_attendance, x45_leadership_position, x48_enforcement_participation,  x53_encourage_regulations, x61f_rights_distribution_fair, x61h_individual_behavior,
           x10_mpa_important, x43_ma_benefits, x43_ma_benefits_opinion, x46_represent_interests, x47_represent_contributions, x52_ma_benefit_5yrs, x53_encourage_regulations, x61a_current_regulations, x61e_violations_decrease_profit, x62_reserve_compliance, x64_wrong_fishing_reserve,
x7_gender, 
x11a_income_farming, x11a_months_farming, x11b_income_harvesting, x11b_months_harvesting, x11c_income_fishing_artisanal,  x11c_months_fishing_artisanal, x11d_income_fishing_industrial,
x11d_months_fishing_industrial, x11e_income_buying_trading, x11e_months_buying_trading, x11f_income_processing, x11f_months_processing, x11g_income_aquaculture, x11g_months_aquaculture, x11h_income_extraction,
x11h_months_extraction, x11i_income_tourism, x11i_months_tourism,   x11j_income_other_wage, x11j_months_other_wage, x11k_income_other,
x11k_months_other, x11k_other_source, 
x12a_fishing_men, x12b_fishing_women, x12c_fishing_children, 
x19_current_fish_catch, 
x22_catch_5yrs,                   
x23_job_secure, 
x30_trust_community,x30_trust_community_neighbors, x30_trust_fishers_community,
x30_trust_fishers_other, x30_trust_local_decision,
x30_trust_ngo, x30_trust_regional_decision, x30_trust_religious_leaders,
x30_trust_village_alert, x31_my_community_ability,
x38_reserve_fishing_allowed, 
x39_ma_boundaries_aware, 
x40_reserve_boundaries_aware,
x49_enforcement_responsible,
x50_ma_punishment,
x51a_fishers_gear_not_permitted, x51b_fishers_reserves, 
x51c_fishers_ma_area, x51d_fishers_violate_fish_size, x51e_fishers_caught,
x55_worry_food, x55_worry_food,
x56_reduce_meal_size_adult,  
x60_hh_fish_consumption,
x61b_catch_recording, x61c_community_participation, x61d_strong_enforcement, 
x61h_individual_behavior,
x61i_help_neighbors,
x66_reaction_fishing_reserve, x66_response_fishing_reserve)) %>% 
 mutate_at(c(13:14), ~replace(., is.na(.), 0)) %>% 
  
## x44_meeting_attendance - x61g_fishing_change_behavior = Engagement questions (col 13:18)
  ## x10_mpa_important - x64_wrong fishing_reserve = Agreement Questions (col 19:29)
  ## From there, I add the "supporting questions" - these do not get drop_na() 'filter' (col 30:91)
  drop_na(13:18, 19, 20, 22:24, 25, 28, 29)
  #While dropping NAs, I ran a pseudo-sensitivity analysis, and questions 61a and 63, wildly decrease the sample size.
```

 *For Questions 44 and 45* 
 Iused mutate_at() to change NAs to 0s. right now it may looks weird, but soon it will all be zeroes and ones. These were only asked to "fisher households" and reduce N a lot. They pair with Questions 46 and 47 (also only asked to fisher households)
*For Q 46-47* we've excluded NAs since they mostly represent "non-fisher households" The difference in n goes from 5640 to ~3300. We want to see how *fishers* comply though. So the smaller N will show us that. 




Let's get a quick `count` table of this data

Here is Global Counts for Filtered A/E data
```{r}


global_filtered_count <- global_filtered %>% 
  count(ma_name) %>% 
  arrange(-n) %>% 
  #mutate(level1_name = fct_reorder(level1_name, n, sum)) %>% 
  adorn_totals("row") %>% 
  rename("Managed Access Area" = ma_name) %>% 
  rename("Number of surveys with all 'Agreement' and 'Engagement' questions answered" = n)





```


##### Coding values to survey Answers


I'll start reassigning 0s and 1 to all the binary Questions
**This is not final** I'm exploring the methods to do this in code, next week Tasha and I will decide the actual valuation of each piece. 


Let me list out which A and E questions have binary responses, if the majority of these have "neither agree nor disagree," then I'll move from -1 to 1, with a neutral option. 


###### Engagement

Apologies for listing these so many times, that will change in the final Rmd. 

- 44: Yes/No 1/-1 (We recoded not sure to No, see Methods)
- 45: Yes/No 1/-1 (We recoded 'Not sure to No, see Methods)
- 48: Yes/No/  No enforcement 1/0/-1 
- 53: Very Often - Never, community has no fishing regulations [Flag for this being its own index]
- 61 (f): Likert Scale (Strongly) Agree-Disagree 
- 61 (g): Likert Scale (Strongly) Agree-Disagree

IS there a standard for emasurign Qs against on another? Should we have our eyes out for some danger in making this index? Any ideas what could happen? 
IS -1 to 1 reasonable? What about using the likerts 

Not sure --> No. we ahve the rationale that engagement would 
"compress often and very often? 0.5 and 1?" 
generally deal with issue of likert scale, using ordinal but not implying that "very often" is 2x good. 

Watch allison ordinal 


###### Agreement

- 10: Yes/No/Neutral 1,0,-1
- 43: Yes/No: 1, -1 (was there an Unsure answer here?)
- 46: Agree/Neutral/Disagree: 1, 0. -1
- 47: Agree/Neutral/Disagree: 1, 0. -1
- 52: Yes, No, Unsure: 1, 0,-1
- 61(a): Likert Scale (Strongly) Agree-Disagree
- 61(e): Likert Scale (Strongly) Agree-Disagree
- 62: Belief that fish catch will... Go up, Go down, remain the same, unsure. 1, 0, -1
- 64:  

For 64, which one is included, is 63 included? 



I'll start converting the "easy" questions to 1s and 0s. 

**Because there was smuch much dang coding in the global_filtered, I'll make a new dataframe for the numbered version. 

We'll call it **global_filtered_numeric**


```{r}
global_filtered_numeric <- global_filtered %>%
  mutate_at(c(1:2), ~replace(., is.na(.), 0)) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "Yes male", replacement = "yes")) %>% 
      mutate(x44_meeting_attendance =
    str_replace(x44_meeting_attendance,
                pattern = "Yes female", replacement = "yes")) %>%
  mutate(x44_meeting_attendance =
    str_replace(x44_meeting_attendance,
                pattern = "No", replacement = "no")) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "not sure", replacement = "no")) %>% 
  mutate(x44_meeting_attendance = 
           str_replace(x44_meeting_attendance,
    pattern = "No", replacement = "no")) %>%
  mutate(x44_meeting_attendance = ifelse(x44_meeting_attendance == "no",0,1)) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "Yes male", replacement = "yes")) %>% 
      mutate(x45_leadership_position =
    str_replace(x45_leadership_position,
                pattern = "Yes female", replacement = "yes")) %>%
  mutate(x45_leadership_position =
    str_replace(x45_leadership_position,
                pattern = "No", replacement = "no")) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "not sure", replacement = "no")) %>% 
  mutate(x45_leadership_position = 
           str_replace(x45_leadership_position,
    pattern = "No", replacement = "no")) %>%
  mutate(x45_leadership_position = ifelse(x45_leadership_position == "no",0,1)) %>%
  mutate(x48_enforcement_participation = 
           str_replace(x48_enforcement_participation,
    pattern = "Yes male", replacement = "yes")) %>%
  mutate(x48_enforcement_participation = 
           str_replace(x48_enforcement_participation,
    pattern = "Yes female", replacement = "yes")) %>%
   mutate(x48_enforcement_participation = 
           str_replace(x48_enforcement_participation,
    pattern = "Yes female, Yes male", replacement = "yes")) %>%
  arrange(x61a_current_regulations)

  # mutate(x48_enforcement_participation = 
           str_replace(x48_enforcement_participation,
    pattern = "Yes female, Yes male", replacement = "yes")) %>% 
  str_replace_all(global_filtered_numeric$conference, 
                  c("No, No" = "no",
                    "No, No, No" = "no",
                    "No, No, No, No" = "no",
                    "No, No, No, No, No" = "no",
                    "No, No, No, No, No, No" = "no",
                    "No, No, No, No, No, No, No, No, No" = "no",
                    
                    "Yes male, Yes male, Yes female, Yes female, Yes male, Yes male, Yes female, Yes female" = "yes"))


```

Making a reprex

```{r}
library(tidyverse)
library(stringr)
library(reprex)

dfr <- dput(global_filtered_numeric$x48_enforcement_participation [157:169])

dfr

```




